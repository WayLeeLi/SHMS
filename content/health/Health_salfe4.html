<div>
	<h2 style="text-align: center;">不法侵害預防計畫</h2>
	<div class="jsgrid" style="position: relative; height: auto; width: 100%;">
		<div class="jsgrid-grid-header jsgrid-header-scrollbar">
			<table class="jsgrid-table">
				<tr class="jsgrid-header-row">
					<th class="jsgrid-header-cell jsgrid-header-sortable">計畫名稱</th>

					<th class="jsgrid-header-cell jsgrid-header-sortable">狀態</th>

				</tr>

			</table>
		</div>
		<div class="jsgrid-grid-body">
			<table class="jsgrid-table">
				<tbody>
					<tr class="jsgrid-row">
						<td class="jsgrid-cell" style="width: 100px;">人因性危害預防計畫</td>
						<td class="jsgrid-cell jsgrid-control-field jsgrid-align-center" style="width: 100px;"><button
								type="button" class="btn btn-primary">檢視內容</button></td>
					</tr>
					<tr class="jsgrid-alt-row">
						<td class="jsgrid-cell" style="width: 100px;">異常工作負荷預防計畫</td>

						<td class="jsgrid-cell jsgrid-control-field jsgrid-align-center" style="width: 100px;"><button
								type="button" class="btn btn-primary">回覆</button></td>
					</tr>
					<tr class="jsgrid-row">
						<td class="jsgrid-cell" style="width: 100px;">母性保護預防計畫</td>
						<td class="jsgrid-cell jsgrid-control-field jsgrid-align-center" style="width: 100px;"><button
								type="button" class="btn btn-primary">檢視內容</button></td>
					</tr>
					<tr class="jsgrid-alt-row">
						<td class="jsgrid-cell" style="width: 100px;">不法侵害預防計畫</td>

						<td class="jsgrid-cell jsgrid-control-field jsgrid-align-center" style="width: 100px;"><button
								type="button" class="btn btn-primary">主管問卷</button> <button
								type="button" class="btn btn-success">環境評估</button></td>
					</tr>

				</tbody>
			</table>
		</div>

	</div>
	<br>

	<form id="inputForm">
		<h2 style="text-align: center;">不法侵害預防計畫</h2>
		<br />
		<table class="w-100 safe_form">
			<tbody>

				<tr>
				<tr>
					<td class="table-header " width="200">職場不法侵害行為自主檢核項目</td>
					<td class="" colspan="2">

						<label>
							<input type="checkbox" checked name="8" /> 持續的吹毛求疵，在小事上挑剔，把微小的錯誤放大、扭曲。
						</label><br>
						<label>
							<input type="checkbox" name="8" /> 總是批評並拒絕看見被霸凌者的貢獻或努力，也持續地否定被霸凌者的存在與價值。
						</label><br>
						<label>
							<input type="checkbox" name="8" /> 總是試圖貶低被霸凌者個人、職位、地位·價值與潛力。
						</label><br>
						<label>
							<input type="checkbox" name="8" /> 在職場中被特別挑出來負面地另眼看待，孤立被霸凌者，對其特別苛刻，用各小動作欺負被霸凌者。
						</label><br>
						<label>
							<input type="checkbox" name="8" /> 以各種方式鼓動同事孤立被霸凌者、不讓被霸凌者參與重要事務或社交活動，把被霸凌者邊緣化，忽視、打壓排擠及冷凍被霸凌者。
						</label><br>
						<label>
							<input type="checkbox" name="8" />在他人面前輕視或貶抑被霸凌者。
						</label><br>
						<label>
							<input type="checkbox" name="8" /> 在私下或他人面前對被霸凌者咆哮、羞辱或威脅。
						</label><br>
						<label>
							<input type="checkbox" name="8" /> 給被霸凌者過重的工作，或要其大材小用去做無聊的瑣事，甚至完全不給被霸凌者任何事做。
						</label><br>
						<label>
							<input type="checkbox" name="8" /> 剽竊被霸凌者的工作成果或聲望。
						</label><br>
						<label>
							<input type="checkbox" name="8" /> 不准被霸凌者請假。
						</label><br>
						<label>
							<input type="checkbox" name="8" /> 不准被霸凌者接受必要的訓練，導致其工作績效不佳。
						</label><br>
						<label>
							<input type="checkbox" name="8" /> 給予被霸凌者不實際的工作目標，或當其正努力朝向目標時，卻給被霸凌者其他任務以阻礙其前進。
						</label><br>
						<label>
							<input type="checkbox" name="8" /> 突然縮短交件期限，或故意不通知被霸凌者工作時限，害其誤了時限而遭到處分。
						</label><br>
						<label>
							<input type="checkbox" name="8" /> 將被霸凌者所說或做的都加以扭曲與誤解。
						</label><br>
						<label>
							<input type="checkbox" name="8" /> 用不是理由的理由且未加調查下，對被霸凌者犯下的輕微錯誤給予沈重處罰。
						</label><br>
						<label>
							<input type="checkbox" name="8" /> 在未犯錯的情形下要求被霸凌者離職或退休。
						</label>

					</td>

				</tr>



			</tbody>
		</table>
		<br>
		<div class="m_t50 m_b30">

			<P>1.若所列舉之行為勾選愈多，宜注意調整對同仁之態度。</P>
			<P>2.參考資料來源:勞勤部工作生活平衡綱(勞工活力補給\職場萬花筒\如何處理職場霸凌\職場霸凌面面觀\<a
					href="https://wlb.mol.govtw/Page/Content.aspx?id=116">https://wlb.mol.gov.tw/Page/Content.aspx?id=116</a>)
			</P>

		</div>
	</form>
</div>
<br>
<div style="text-align: center;">

	<button type="button" id="submitBtn" class="btn btn-success  my-2">送出</button>

	<button type="button" id="printBtn" class="btn btn-secondary  my-2">返回</button>
</div>


<div id="tableDialog" style="display:none" class="container">
	<form id="dialogForm">
		<div class="te">
			<textarea placeholder="退件原因" class="w-100" style="height: 120px;"></textarea>
		</div>

		<div style="text-align: center;">

			<button type="button" id="submitBtnx" class="btn btn-primary  my-2">儲存送出</button>

		</div>
	</form>
</div>

<style>
	/* 讓表格內容換行 */
	.jsgrid-table {
		word-wrap: break-word;
	}

	input[type=text] {
		width: 100%;
	}

	textarea {
		width: 100%;
	}
</style>

<script>
	//需要用的JS
	require(["jquery", "jquery_validate", "jsgrid", "jquery_ui"], function (jquery, jquery_validate, jsgrid, jquery_ui) {
		//頁面讀取後執行
		$(document).ready(function () {
			//取得日期
			$("#fordate").datepicker({
				dateFormat: "yy/mm/dd",
				maxDate: new Date()
			});
			$('#startDate').datepicker({

				autoclose: true, //選擇後自動關閉
				format: 'yy/mm/dd',
				maxDate: new Date(),
			}).on('changeDate', function (e) {
				var startTime = e.date;
				$('#endDate').datepicker('setStartDate', startTime);
			});

			$('#endDate').datepicker({

				autoclose: true, //選擇後自動關閉
				format: 'yy/mm/dd',
				maxDate: new Date(),
				minDate: $("#startDate").val(),
			}).on('changeDate', function (e) {
				var endTime = e.date;
				$('#startDate').datepicker('setEndDate', endTime);
			});

			$.ajax({
				url: "/" + CONFIG.SYSTEM_NAME + '/config/api/getConfig',
				contentType: "application/json;charset=utf-8", // 因為上面是JSON資料
				async: false,
				cache: false,
				type: "GET",
				success: function (data, textStatus) {
					if (data.code == 4000) {
							alert('您登入已逾時或未登入，請重新登入！')
							location.href = "/" + CONFIG.SYSTEM_NAME + "/page/login.html";

						}if (data && data.code == 5000) {
							//showAlert('沒有權限','沒有權限','')
							showAlert('沒有權限', '沒有權限', '')
						} else {
						var data = new Array(
							{
								"NUMS": "第一次",
								"UNAME": "蔡小雯",
								"GNAME": "蔡小雯",
								"REMARKS": "2021/12/12",
								"TIME": "2021/12/12",
								"UNIT": "是",

							}, {
							"NUMS": "第二次",
							"UNAME": "蔡小雯",
							"GNAME": "蔡小雯",
							"REMARKS": "2021/12/12",
							"TIME": "2021/12/12",
							"UNIT": "是",

						}, {
							"NUMS": "第三次",
							"UNAME": "蔡小雯",
							"GNAME": "蔡小雯",
							"REMARKS": "2021/12/12",
							"TIME": "2021/12/12",
							"UNIT": "是",

						}, {
							"NUMS": "第四次",
							"UNAME": "蔡小雯",
							"GNAME": "蔡小雯",
							"REMARKS": "2021/12/12",
							"TIME": "2021/12/12",
							"UNIT": "是",

						}, {
							"NUMS": "第五次",
							"UNAME": "蔡小雯",
							"GNAME": "蔡小雯",
							"REMARKS": "2021/12/12",
							"TIME": "2021/12/12",
							"UNIT": "是",
						}, {
							"NUMS": "第六次",
							"UNAME": "蔡小雯",
							"GNAME": "蔡小雯",
							"REMARKS": "2021/12/12",
							"TIME": "2021/12/12",
							"UNIT": "是",

						});

						$("#jsGrid").jsGrid({
							width: "100%",
							height: "auto",
							heading: true, //是否顯示表頭
							filtering: false, //啟動查找
							inserting: false, //啟動新增  關掉使用自定義的
							editing: true,  //啟動編輯 
							selecting: true,
							sorting: true, //啟動排序
							paging: true, //啟動分頁 
							pageLoading: false, //是否支援分頁載入資料（相比較paging，這個屬性是向伺服器請求資料時要求分頁，而paging是本地進行分頁，無關伺服器）
							autoload: true,
							pageSize: 10,

							controller: {
								loadData: function (filter) {
									//查詢
									var result = $.grep(data, function (item, idx) {
										for (var key in filter) {
											var value = filter[key];
											if (value.length > 0) {
												if (!item[key]) {
													return false;
												}
												if (typeof item[key] === 'number') {
													if (item[key].toString().indexOf(value) == -1) {
														return false;
													}
												} else if (typeof item[key] === 'string') {
													if (item[key].indexOf(value) == -1) {
														return false;
													}
												}

											}
										}
										return true;
									});
									return result;
								},
								insertItem: function (insertingItem) {
									$.ajax({
										url: "/" + CONFIG.SYSTEM_NAME + '/config/api/addConfig',
										data: JSON.stringify(insertingItem),
										contentType: "application/json;charset=utf-8", // 因為上面是JSON資料
										async: false,
										cache: false,
										type: "POST",
										success: function (data, textStatus) {
											if (data && data == "<script>alert('沒有權限')<\/script>") {
												alert("沒有權限");
											} else {
												if (data.result == "success") {
													insertingItem.id = data.id;
													alert("新增成功");
												} else if (data.errorMsg) {
													alert(data.errorMsg);
												}
											}
										},
										error: function (data, textStatus, errorThrown) {
											console.log(data);
										},
									});
								},
								updateItem: function (updatingItem) {
									$.ajax({
										url: "/" + CONFIG.SYSTEM_NAME + '/config/api/updateConfig',
										data: JSON.stringify(updatingItem),
										contentType: "application/json;charset=utf-8", // 因為上面是JSON資料
										async: false,
										cache: false,
										type: "POST",
										success: function (data, textStatus) {
											if (data && data == "<script>alert('沒有權限')<\/script>") {
												alert("沒有權限");
											} else {
												if (data.result == "success") {
													alert("更新成功");
												} else if (data.errorMsg) {
													alert(data.errorMsg);
												}
											}
										},
										error: function (data, textStatus, errorThrown) {
											console.log(data);
										},
									});
								},
								deleteItem: function (deletingItem) {
									$.ajax({
										url: "/" + CONFIG.SYSTEM_NAME + '/config/api/deleteConfig',
										data: '{"ID":' + deletingItem.id + '}',
										contentType: "application/json;charset=utf-8", // 因為上面是JSON資料
										async: false,
										cache: false,
										type: "POST",
										success: function (data, textStatus) {
											if (data && data == "<script>alert('沒有權限')<\/script>") {
												alert("沒有權限");
											} else {
												if (data.result == "success") {
													alert("刪除成功");
												} else if (data.errorMsg) {
													alert(data.errorMsg);
												}
											}
										},
										error: function (data, textStatus, errorThrown) {
											console.log(data);
										},
									});
								}
							},

							fields: [
								{ title: "項次", name: "NUMS", type: "text", },
								{ title: "上傳日期", name: "TIME", type: "text", },
								{ title: "警鈴連線測試", name: "UNIT", type: "text", },
								{ title: "未完成原因(敘明無測試月份)", name: "REMARKS", type: "text", validate: "required" },

								{ title: "填表人", name: "UNAME", type: "text", validate: "required" },
								{ title: "審核人員", name: "GNAME", type: "text", validate: "required" },

							],
							rowClick: function (args) {

								// bodyHref("/content/situation/Safetysituationreport_form.html");
								//showDetailsDialog("修改", args.item);
							},
							deleteConfirm: function (item) {
								return "參數\"" + item.NUM + "\"確認刪除?";
							},
						});
					}
				},
				error: function (data, textStatus, errorThrown) {
					console.log(data);
				},
			});

			$("#tableDialog").dialog({
				title: "參數設定",
				autoOpen: false,
				width: 550,
				modal: true,
				open: function () {
					$('.ui-widget-overlay').addClass('custom-overlay');
					customCloseBtn();
				},
				close: function () {

					$("#dialogForm").find(".error").removeClass("error");
					$('.ui-widget-overlay').removeClass('custom-overlay');
				},
				classes: dlgSetting.classes,
				show: dlgSetting.show,
				hide: dlgSetting.hide
			});

			var formSubmitHandler = $.noop;

			var showDetailsDialog = function (dialogType, item) {

				$("#tableDialog").dialog("option", "title", dialogType + "").dialog("open");
			};

			$("#dialogForm").validate({
				//錯誤訊息元素預設為label改成p會換行
				errorElement: "p",
				rules: {
					cfgType: { required: true, rangelength: [2, 50] },
					cfgKey: { required: true, rangelength: [3, 80] },
					cfgName: { required: true, rangelength: [2, 50] },
					cfgValue: { required: true, rangelength: [0, 80] },
					cfgInUse: { required: true }
				},
				messages: {
					cfgType: {
						required: "請輸入參數類型",
						rangelength: "密碼長度不得小於2個字母大於50個字母"
					},
					cfgKey: {
						required: "請輸入參數key",
						rangelength: "參數key不得小於4個字母大於80個字母"
					},
					cfgName: {
						required: "請輸入參數名稱",
						rangelength: "參數名稱不得小於2個字母大於50個字母"
					},
					cfgValue: {
						required: "請輸入參數值",
						rangelength: "參數值不得小於0個字母大於80個字母"
					},
					cfgInUse: {
						required: "請選擇是否啟用"
					}
				},
				submitHandler: function () {
					formSubmitHandler();
				}
			});

			var saveItem = function (item, isNew) {
				$.extend(item, {
					cfgType: $("#cfgType").val(),
					cfgKey: $("#cfgKey").val(),
					cfgName: $("#cfgName").val(),
					cfgValue: $("#cfgValue").val(),
					cfgMemo: $("#cfgMemo").val(),
					cfgInUse: $('input[name*=cfgInUse]:checked').val()
				});

				$("#jsGrid").jsGrid(isNew ? "insertItem" : "updateItem", item);

				$("#tableDialog").dialog("close");
				bodyHref("/content/situation/Safetysituationreport.html");
			};

			function Processing(id) {
				bodyHref("/content/situation/Safetysituationreport_form7.html");
			}

		});

		$('#downloadExcelBtn').on("click", function () {
			showDetailsDialog("退件原因", {});
		});
		$("#tableDialog").dialog({
			title: "退件原因",
			autoOpen: false,
			width: 550,
			modal: true,
			open: function () {
				$('.ui-widget-overlay').addClass('custom-overlay');
				customCloseBtn();
			},
			close: function () {

				$("#dialogForm").find(".error").removeClass("error");
				$('.ui-widget-overlay').removeClass('custom-overlay');
			},
			classes: dlgSetting.classes,
			show: dlgSetting.show,
			hide: dlgSetting.hide
		});

		var formSubmitHandler = $.noop;

		var showDetailsDialog = function (dialogType, item) {

			$("#tableDialog").dialog("option", "title", dialogType + "").dialog("open");
		};
	});
</script>
